

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Degenerate Electrons &#8212; PHY 521 Fall 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'eos/degeneracy-parameter';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EOS regimes" href="eos-regimes.html" />
    <link rel="prev" title="PHY 521: Stars" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">PHY 521 Fall 2023</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    PHY 521: Stars
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Equation of State</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Degenerate Electrons</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos-regimes.html">EOS regimes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reactions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../pp-vs-cno/pp-cno.html">p-p chain vs. CNO</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reaction_networks/stiff-ODEs.html">Integrating Stiff ODEs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reaction_networks/ODEs-implicit.html">Implicit Methods for ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reaction_networks/ODEs-implicit-systems.html">Implicit Methods for Systems of ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reaction_networks/ODEs-implicit-nonlinear-systems.html">Implicit Methods and Nonlinear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reaction_networks/cxx_solver.html">C++ Solver for Stiff Nonlinear System</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reaction_networks/reactions.html">Application: Nuclear Reaction Networks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reaction_networks/application-CNO-network.html">Integration Example</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stellar Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../polytrope/lane-emden.html">Lane-Emden polytrope equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../polytrope/lane-emden-shooting.html">Solving Lane-Emden via Shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stellar_evolution/stellar-models.html">Exploring MESA models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Close Binary Evolution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../equipotentials/equipotentials.html">Equipotentials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explosions!</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../hotcno/hot-CNO-breakout-example.html">hot-CNO and breakout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lightcurves/lightcurves.html">Simple supernova lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nse/nse.html">Nuclear statistical equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TOV/tov.html">Neutron star structure</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../homework/homework1-solutions.html">Homework 1 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework2-solutions.html">Homework 2 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework3-solutions.html">Homework 3 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework4-solutions.html">Homework 4 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework5-solutions.html">Homework 5 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework6-solutions.html">Homework 6 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework7-solutions.html">Homework 7 solutions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/zingale/stars/main?urlpath=tree/content/eos/degeneracy-parameter.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/zingale/stars/blob/main/content/eos/degeneracy-parameter.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/zingale/stars" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/zingale/stars/issues/new?title=Issue%20on%20page%20%2Feos/degeneracy-parameter.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/eos/degeneracy-parameter.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Degenerate Electrons</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-to-degeneracy">Transition to Degeneracy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-degeneracy-parameter">Computing the Degeneracy Parameter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-trend-of-psi-with-rho-t">Finding the trend of <span class="math notranslate nohighlight">\(\Psi\)</span> with <span class="math notranslate nohighlight">\(\rho, T\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-psi">Visualizing <span class="math notranslate nohighlight">\(\Psi\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-pressure">Computing Pressure</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="degenerate-electrons">
<h1>Degenerate Electrons<a class="headerlink" href="#degenerate-electrons" title="Permalink to this heading">#</a></h1>
<p>In white dwarfs, electron degeneracy pressure provides the dominant support against gravity.  Electrons are fermions, and when the density of the star is high, they are packed closely together.  Quantum mechanical effects come into play, and the electrons no longer behave as an ideal gas, but instead exhibit large pressure even at very low (or zero) temperature.</p>
<p>The origin of this is <a class="reference external" href="https://en.wikipedia.org/wiki/Fermi%E2%80%93Dirac_statistics">Fermi-Dirac statistics</a>—no two electrons can occupy the same state, so as they get confined to a smaller and smaller volume, they need to take on larger momenta.</p>
<p>The distribution function describes the properties of the electrons, and has the following meaning: <span class="math notranslate nohighlight">\(n(p) d^3 x d^3 p\)</span> is the number of particles with momentum <span class="math notranslate nohighlight">\(p\)</span> in a volume <span class="math notranslate nohighlight">\(d^3x\)</span>.  Our distribution function is:</p>
<div class="math notranslate nohighlight">
\[n(p) = \frac{2}{h^3} \frac{1}{e^{\mathcal{E}(p)/{k_B T} - \Psi} + 1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{E}\)</span> is the kinetic energy of the electron, <span class="math notranslate nohighlight">\(T\)</span> is the temperature, and <span class="math notranslate nohighlight">\(\Psi\)</span> is the <em>degeneracy parameter</em> which is related to the chemical potential, <span class="math notranslate nohighlight">\(\mu\)</span>, and the <a class="reference external" href="https://en.wikipedia.org/wiki/Fermi_energy">Fermi energy</a>, <span class="math notranslate nohighlight">\(\mathcal{E}_F\)</span>, as:</p>
<div class="math notranslate nohighlight">
\[\Psi = \frac{\mu - m_e c^2}{k_B T} = \frac{\mathcal{E}_F}{k_B T}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some sources use <span class="math notranslate nohighlight">\(\eta\)</span> instead of <span class="math notranslate nohighlight">\(\Psi\)</span> for the degeneracy parameter</p>
</div>
<p>The electrons are degenerate when <span class="math notranslate nohighlight">\(\Psi \gg 1\)</span>, which means that the Fermi energy is much greater than the thermal energy.  The electrons behave as an ideal gas when <span class="math notranslate nohighlight">\(-\Psi \gg 1\)</span> (in this case, the <span class="math notranslate nohighlight">\(+1\)</span> in the denominator of <span class="math notranslate nohighlight">\(n(p)\)</span> is insignificant and we get the Maxwell-Boltzmann distribution).</p>
<p>To get the <em>number density</em>, we integrate over all momenta:</p>
<div class="math notranslate nohighlight">
\[n = \int n(p) d^3 p\]</div>
<p>The pressure and specific internal energy, <span class="math notranslate nohighlight">\(e\)</span>, are then found as:</p>
<div class="math notranslate nohighlight">
\[P = \frac{1}{3} \int n(p) v(p) p d^3 p\]</div>
<div class="math notranslate nohighlight">
\[\rho e = \int n(p) \mathcal{E}(p) d^3 p\]</div>
<section id="transition-to-degeneracy">
<h2>Transition to Degeneracy<a class="headerlink" href="#transition-to-degeneracy" title="Permalink to this heading">#</a></h2>
<p>Let’s look at the behavior of the distribution function.  Consider:</p>
<div class="math notranslate nohighlight">
\[F(\mathcal{E}) = \frac{1}{e^{\mathcal{E}/k_B T - \Psi} + 1}\]</div>
<p>let’s define</p>
<div class="math notranslate nohighlight">
\[\xi \equiv \frac{\mathcal{E}}{k_B T}\]</div>
<p>then we have</p>
<div class="math notranslate nohighlight">
\[F(\xi) = \frac{1}{e^{\xi - \Psi} + 1}\]</div>
<p>and for each choice of <span class="math notranslate nohighlight">\(\Psi\)</span> we have a unique distribution.</p>
<p>We note that <span class="math notranslate nohighlight">\(\xi/\Psi = \mathcal{E}/\mathcal{E}_F\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">psi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s look at the case of <span class="math notranslate nohighlight">\(\Psi &gt; 1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># we&#39;ll work in terms of r = xi / Psi</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="k">for</span> <span class="n">psi</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="n">psi</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="n">psi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\Psi = </span><span class="si">{</span><span class="n">psi</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$F$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathcal</span><span class="si">{E}</span><span class="s2">/\mathcal</span><span class="si">{E}</span><span class="s2">_F$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\mathcal{E}/\\mathcal{E}_F$&#39;)
</pre></div>
</div>
<img alt="../_images/8ffb08b6201bfeee164afeca7c32b9ae269b191acb358877200f486f3331934b.png" src="../_images/8ffb08b6201bfeee164afeca7c32b9ae269b191acb358877200f486f3331934b.png" />
</div>
</div>
<p>As we see, as <span class="math notranslate nohighlight">\(\Psi \rightarrow \infty\)</span>, the distribution, <span class="math notranslate nohighlight">\(F(\mathcal{E})\)</span> becomes a step function.  This is the limit of complete degeneracy, and we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(\mathcal{E}) = \left \{ \begin{array}{cc} 1 &amp; \mathcal{E} &lt; \mathcal{E}_F \\
                                              0 &amp; \mathcal{E} &gt; \mathcal{E}_F \end{array} \right .\end{split}\]</div>
<p>We can alternately use the Fermi momentum, <span class="math notranslate nohighlight">\(p_F\)</span> to describe the location of the step.</p>
<p>With this form, the integral for number density is trivial:</p>
<div class="math notranslate nohighlight">
\[n_e = \frac{8\pi}{h^3} \int_0^{\mathcal{p}_F} p^2 dp\]</div>
<p>where we switched to spherical coordinates in momentum space: <span class="math notranslate nohighlight">\(d^3p \rightarrow 4\pi p^2 dp\)</span>.</p>
</section>
<section id="computing-the-degeneracy-parameter">
<h2>Computing the Degeneracy Parameter<a class="headerlink" href="#computing-the-degeneracy-parameter" title="Permalink to this heading">#</a></h2>
<p>For other values of <span class="math notranslate nohighlight">\(\Psi\)</span>, we have a problem:</p>
<div class="math notranslate nohighlight">
\[n_e = \frac{8\pi}{h^3} \int_0^\infty \frac{p^2}{e^{\mathcal{E}(p)/k_B T - \Psi} + 1} dp\]</div>
<p>We don’t know what the value of <span class="math notranslate nohighlight">\(\Psi\)</span> is ahead of time.  Instead, we typically know what the density of the star is, and we can find the
number density of electrons as:</p>
<div class="math notranslate nohighlight">
\[n_e = \frac{\rho Y_e}{m_u}\]</div>
<p>where <span class="math notranslate nohighlight">\(Y_e\)</span> is the electron fraction (typically around <span class="math notranslate nohighlight">\(1/2\)</span> for compositions heavier than hydrogen).  This means that given <span class="math notranslate nohighlight">\(\rho, T\)</span>,
we can solve for <span class="math notranslate nohighlight">\(\Psi\)</span>.</p>
<p>Once we have <span class="math notranslate nohighlight">\(\Psi\)</span>, we can then find the pressure and energy of the gas.</p>
<section id="finding-the-trend-of-psi-with-rho-t">
<h3>Finding the trend of <span class="math notranslate nohighlight">\(\Psi\)</span> with <span class="math notranslate nohighlight">\(\rho, T\)</span><a class="headerlink" href="#finding-the-trend-of-psi-with-rho-t" title="Permalink to this heading">#</a></h3>
<p>Let’s now implement an algorithm to find the <span class="math notranslate nohighlight">\(\Psi\)</span> that corresponds to an input <span class="math notranslate nohighlight">\(\rho\)</span> (or <span class="math notranslate nohighlight">\(n_e\)</span>) and <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>We first need a function to compute <span class="math notranslate nohighlight">\(n_e\)</span> given a <span class="math notranslate nohighlight">\(T\)</span> and a guess for <span class="math notranslate nohighlight">\(\Psi\)</span>.</p>
<p>The kinetic energy of a particle can be found from the relativisitic expression:</p>
<div class="math notranslate nohighlight">
\[\mathcal{E}(p) = m_e c^2 \left [ \sqrt{1 + \left ( \frac{p}{m_e c} \right )^2 } - 1 \right ]\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This has the proper limit in the non-relativistic case, <span class="math notranslate nohighlight">\(|p| \ll m_e c\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{E} = \frac{p^2}{2m_e}\]</div>
</div>
<p>Defining <span class="math notranslate nohighlight">\(x = p/(m_e c)\)</span> and <span class="math notranslate nohighlight">\(\alpha = m_e c^2 / (k_B T)\)</span>, our integral becomes:</p>
<div class="math notranslate nohighlight">
\[n_e = \frac{8\pi}{h^3} (m_e c)^3 \int_0^\infty \frac{x^2 dx}{e^{\alpha (\sqrt{1 + x^2} - 1) - \Psi} + 1}\]</div>
<p>We need to do this numerically</p>
<p>Let’s write a function that returns the integrand.  Note, we run a risk of the exponential in the denominator overflowing, especially when <span class="math notranslate nohighlight">\(\alpha\)</span> is large (<span class="math notranslate nohighlight">\(T\)</span> is small).  So we take <code class="docutils literal notranslate"><span class="pre">exp(500)</span></code> to be infinite and set the integrand to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>we’ll need the constants</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CGS constants</span>

<span class="n">h_planck</span> <span class="o">=</span> <span class="mf">6.63e-27</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-16</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-28</span>
<span class="n">m_u</span> <span class="o">=</span> <span class="mf">1.67e-24</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.99792e10</span>
</pre></div>
</div>
</div>
</div>
<p>Now a function that returns <span class="math notranslate nohighlight">\(n_e\)</span>.  This does the integral using SciPy, and adds in the physical constants to give us <span class="math notranslate nohighlight">\(n_e\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">optimize</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_ne</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;given a temperature and degeneracy parameter, psi,</span>
<span class="sd">    compute the number density of electrons by integrating</span>
<span class="sd">    the Fermi-Dirac distribution over all momenta&quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">I</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">psi</span><span class="p">),</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.e-10</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.e-10</span><span class="p">)</span>
    <span class="n">ne</span> <span class="o">=</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">h_planck</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">I</span>
    <span class="k">return</span> <span class="n">ne</span>
</pre></div>
</div>
</div>
</div>
<p>Now we want to do a root find on this, to find the value of <span class="math notranslate nohighlight">\(\Psi\)</span> that gives us our desired <span class="math notranslate nohighlight">\(n_e\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_psi</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ye</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    
    <span class="n">ne_input</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Ye</span> <span class="o">/</span> <span class="n">m_u</span>
    <span class="n">psi_low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
    <span class="n">psi_high</span> <span class="o">=</span> <span class="mi">100000</span>
    
    <span class="n">psi</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">psi</span><span class="p">:</span> <span class="n">ne_input</span> <span class="o">-</span> <span class="n">compute_ne</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi</span><span class="p">),</span> <span class="n">psi_low</span><span class="p">,</span> <span class="n">psi_high</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find_psi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.e6</span><span class="p">,</span> <span class="n">Ye</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.7566778741961664
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-psi">
<h3>Visualizing <span class="math notranslate nohighlight">\(\Psi\)</span><a class="headerlink" href="#visualizing-psi" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_psi_rho</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.e7</span><span class="p">):</span>
    <span class="n">psis</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">rhos</span><span class="p">:</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">find_psi</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">psis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">psis</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">rhos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.e6</span><span class="p">,</span> <span class="mf">1.e7</span><span class="p">,</span> <span class="mf">1.e8</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">get_psi_rho</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;T = </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s2">5.2g</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Psi$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">1.e-2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f510bf532e0&gt;
</pre></div>
</div>
<img alt="../_images/169846afa05d354e3a0601e3d00eb3edc91cad00418ed8304d38411e7364a760.png" src="../_images/169846afa05d354e3a0601e3d00eb3edc91cad00418ed8304d38411e7364a760.png" />
</div>
</div>
<p>Notice that at high <span class="math notranslate nohighlight">\(T\)</span> and low <span class="math notranslate nohighlight">\(\rho\)</span>, the degeneracy parameter becomes negative–this is when we are an ideal gas.</p>
</section>
</section>
<section id="computing-pressure">
<h2>Computing Pressure<a class="headerlink" href="#computing-pressure" title="Permalink to this heading">#</a></h2>
<p>Now, for the pressure, we need <span class="math notranslate nohighlight">\(v(p)\)</span>:</p>
<div class="math notranslate nohighlight">
\[v(p) = \frac{p}{m_e} \left [ 1 + \left (\frac{p}{m_e c} \right )^2 \right ]^{-1/2}\]</div>
<p>our pressure integral becomes:</p>
<div class="math notranslate nohighlight">
\[P = \frac{8\pi}{3m_e h^3} (m_e c)^5 \int_0^\infty \frac{x^4}{\sqrt{1 + x^2}} \frac{dx}{e^{\alpha (\sqrt{1 + x^2} - 1) - \Psi} + 1}\]</div>
<p>To do this integral, we first need to compute <span class="math notranslate nohighlight">\(\Psi\)</span>.  Here’s the overall pressure function.  At low temperatures / low densities, we need to ensure that the tolerance used by the integrator is tight to get a good solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_integrand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ye</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">find_psi</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ye</span><span class="o">=</span><span class="n">Ye</span><span class="p">)</span>
    <span class="n">I</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">p_integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">psi</span><span class="p">),</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.e-10</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.e-12</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">m_e</span> <span class="o">*</span> <span class="n">h_planck</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">5</span> <span class="o">*</span> <span class="n">I</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_p_rho</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.e7</span><span class="p">):</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">rhos</span><span class="p">:</span>
        <span class="n">ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">ps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">rhos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.e6</span><span class="p">,</span> <span class="mf">1.e7</span><span class="p">,</span> <span class="mf">1.e8</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">get_p_rho</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;T = </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s2">5.2g</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f510bd9e9e0&gt;
</pre></div>
</div>
<img alt="../_images/b61dd47928852124905ea67c46964b924969b220e7984d8165c7b7831538a47c.png" src="../_images/b61dd47928852124905ea67c46964b924969b220e7984d8165c7b7831538a47c.png" />
</div>
</div>
<p>Here you clearly see that hotter temperatures require higher densities before they transition from an ideal gas to degeneracy.  For the coldest line, the <span class="math notranslate nohighlight">\(\alpha\)</span> factor is making the exponential overflow, making the solution a bit unstable.</p>
<p>At zero temperature, the pressure integral can be done analytically, and we find:</p>
<div class="math notranslate nohighlight">
\[x_F = \left (\frac{3}{8\pi} \right )^{1/3} \frac{h}{m_e c} n_e^{1/3}\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[P(x) = \frac{\pi}{3} \left (\frac{m_e c}{h} \right )^3 m_e c^2 \left [ x (2x^2 - 3) (1 + x^2)^{1/2} + 3 \sinh^{-1}x \right ]\]</div>
<p>we can add this line to the pressure plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_zero_temp</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">Ye</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    
    <span class="c1"># find number density</span>
    <span class="n">n_e</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Ye</span> <span class="o">/</span> <span class="n">m_u</span>
    
    <span class="c1"># find Fermi momentum</span>
    <span class="n">x_F</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">h_planck</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">*</span> <span class="n">n_e</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">h_planck</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">m_e</span> <span class="o">*</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_F</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x_F</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x_F</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">x_F</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">P</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">p_zero_temp</span><span class="p">(</span><span class="n">rhos</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8152858d78e04ec43ce1f975478bf7090222d4a9321dfdec5ee75cbc762e0bc4.png" src="../_images/8152858d78e04ec43ce1f975478bf7090222d4a9321dfdec5ee75cbc762e0bc4.png" />
</div>
</div>
<p>Here we see that this zero-temperature curve works really well at low temperatures and at high densities.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./eos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PHY 521: Stars</p>
      </div>
    </a>
    <a class="right-next"
       href="eos-regimes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">EOS regimes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-to-degeneracy">Transition to Degeneracy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-degeneracy-parameter">Computing the Degeneracy Parameter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-trend-of-psi-with-rho-t">Finding the trend of <span class="math notranslate nohighlight">\(\Psi\)</span> with <span class="math notranslate nohighlight">\(\rho, T\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-psi">Visualizing <span class="math notranslate nohighlight">\(\Psi\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-pressure">Computing Pressure</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href="https://zingale.github.io">Michael Zingale</a>
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
&copy; 2023; CC-BY-NC-SA 4.0
<p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>